<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ower.dsyz.admin.manual.dao.AdminInsRoleExtMapper">
	<select id="pageQueryAdminInsRoleList" parameterType="com.ower.dsyz.admin.manual.dto.AdminInsRoleDTO"
		resultType="com.ower.dsyz.admin.manual.dto.AdminInsRoleDTO">
		SELECT DISTINCT
		t.role_id as roleId,
		t.role_name as roleName,
		t.role_code as roleCode,
		t.bus_type_id as busTypeId
		from t_admin_role t
        where 1=1
		<if test="dist=='Y'.toString() and insId !=null and insId !=''">
			and t.role_id in
			(select t2.role_id from t_admin_ins_role t2 where t2.ins_id=
			#{insId,jdbcType=VARCHAR})
		</if>
		<if test="dist=='N'.toString() and insId !=null and insId !=''">
			and t.role_id not in
			(select t2.role_id from t_admin_ins_role t2 where t2.ins_id=
			#{insId,jdbcType=VARCHAR})
		</if>
	</select>

	<delete id="batchDelAdminInsRole" parameterType="com.ower.dsyz.admin.manual.dto.AdminInsRoleDistDTO">
		delete from t_admin_ins_role
		where ins_id = #{insId,jdbcType=VARCHAR}
		<if test="roleIdList!=null and roleIdList.size()&gt;0">
		and role_id in
		<foreach collection="roleIdList" index="index" item="item" open="(" separator="," close=")">
              #{item}       
        </foreach> 
        </if>
	</delete>
</mapper>