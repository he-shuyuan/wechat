<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ower.dsyz.admin.manual.dao.AdminRoleExtMapper">
	<select id="queryAdminRoleDTOList" parameterType="com.ower.dsyz.admin.manual.dto.AdminRoleDTO"
		resultType="com.ower.dsyz.admin.manual.dto.AdminRoleDTO">
		SELECT
		t.role_id AS roleId,
		t.role_code AS roleCode,
		t.role_name AS
		roleName,
		t.is_valid AS isValid,
		t.remark AS remark,
		t.bus_type_id AS
		busTypeId,
		t1.bus_type_name AS busTypeName
		FROM
		t_admin_role t
		LEFT JOIN
		t_admin_business t1 ON t.bus_type_id = t1.bus_type_id
		where 1=1
		<if test="roleId!=null and roleId!=''">
			and t.role_id = #{roleId,jdbcType=VARCHAR}
		</if>
		<if test="roleCode!=null and roleCode!=''">
			and t.role_code = #{roleCode,jdbcType=VARCHAR}
		</if>
		<if test="roleName!=null and roleName!=''">
			and t.role_name like
			concat('%',#{roleName,jdbcType=VARCHAR},'%')
		</if>
		<if test="isValid!=null and isValid!=''">
			and t.is_valid = #{isValid,jdbcType=VARCHAR}
		</if>
		<if test="busTypeId!=null and busTypeId!=''">
			and t.bus_type_id = #{busTypeId,jdbcType=VARCHAR}
		</if>
	</select>
	<select id="pageQueryAdminRoleDTOList" parameterType="com.ower.dsyz.admin.manual.dto.AdminRoleDTO"
		resultType="com.ower.dsyz.admin.manual.dto.AdminRoleDTO">
		SELECT
		t.role_id AS roleId,
		t.role_code AS roleCode,
		t.role_name AS
		roleName,
		t.is_valid AS isValid,
		t.remark AS remark,
		t.bus_type_id AS
		busTypeId,
		t1.bus_type_name AS busTypeName
		FROM
		t_admin_role t
		LEFT JOIN
		t_admin_business t1 ON t.bus_type_id = t1.bus_type_id
		where 1=1
		<if test="roleId!=null and roleId!=''">
			and t.role_id = #{roleId,jdbcType=VARCHAR}
		</if>
		<if test="roleCode!=null and roleCode!=''">
			and t.role_code = #{roleCode,jdbcType=VARCHAR}
		</if>
		<if test="roleName!=null and roleName!=''">
			and t.role_name like
			concat('%',#{roleName,jdbcType=VARCHAR},'%')
		</if>
		<if test="isValid!=null and isValid!=''">
			and t.is_valid = #{isValid,jdbcType=VARCHAR}
		</if>
		<if test="busTypeId!=null and busTypeId!=''">
			and t.bus_type_id = #{busTypeId,jdbcType=VARCHAR}
		</if>
	</select>
	<select id="queryAdminRoleListByUserIdAndInsId" parameterType="java.lang.String"
		resultType="com.ower.dsyz.admin.auto.model.AdminRole">
		SELECT
		t1.role_id as roleId,
		t1.role_name as roleName,
		t1.role_code as roleCode
		FROM
		t_admin_role t1
		LEFT JOIN t_admin_ins_role
		t2 ON t1.role_id = t2.role_id LEFT JOIN
		t_admin_user_role
		t3 on
		t3.role_id = t2.role_id
		where t2.ins_id = #{insId,jdbcType=VARCHAR)
		and
		t3.user_id = #{userId,jdbcType=VARCHAR}
	</select>
</mapper>